# 服务器测试检查表 - 分享页面优化

## 📋 测试前准备

### 1. 服务器环境确认
- [ ] 确认当前在服务器环境（非本地）
- [ ] 检查服务器权限（sudo访问）
- [ ] 确认Git仓库可访问
- [ ] 检查网络连接

### 2. 备份确认
- [ ] 当前代码已备份
- [ ] 数据库已备份
- [ ] 重要配置文件已备份

## 🚀 部署步骤

### 1. 执行部署脚本
```bash
# 在服务器上执行
cd /var/www/RWA-HUB
./deploy_and_test.sh
```

### 2. 手动验证（如果脚本失败）
```bash
# 1. 拉取代码
git fetch origin
git reset --hard origin/main

# 2. 重启服务
sudo systemctl restart rwa-hub
sudo systemctl restart nginx

# 3. 检查状态
sudo systemctl status rwa-hub
sudo systemctl status nginx
```

## 🧪 功能测试

### 1. API端点测试
```bash
# 测试分享消息API
curl -X GET "http://your-server/api/share-messages/random?type=share_content"

# 测试奖励计划API  
curl -X GET "http://your-server/api/share-reward-plan/random"

# 测试分享配置API
curl -X GET "http://your-server/api/share-config"
```

### 2. 页面功能测试

#### 2.1 访问资产详情页
- [ ] 打开任意资产详情页（如：`/assets/RH-10100`）
- [ ] 页面加载正常
- [ ] 分享按钮显示正常

#### 2.2 测试分享功能
- [ ] 点击"分享"按钮
- [ ] 分享模态框正常打开
- [ ] 检查模态框内容：
  - [ ] 分享文案显示
  - [ ] 奖励计划文案显示  
  - [ ] **确认没有重复的"20%团队分成"信息**
  - [ ] 无限层级收益模式显示正确
  - [ ] 专属链接生成成功

#### 2.3 检查优化内容
- [ ] 分享文案和奖励计划文案分别显示
- [ ] 去掉了重复的"持续收益20%团队分成"信息
- [ ] 收益展示更简洁明了
- [ ] 视觉布局更清晰

### 3. 钱包连接测试
- [ ] 未连接钱包时提示连接
- [ ] 连接钱包后显示专属链接
- [ ] 链接包含钱包地址参数

### 4. 响应式测试
- [ ] 桌面端显示正常
- [ ] 平板端显示正常  
- [ ] 手机端显示正常

## 🔍 错误检查

### 1. 日志检查
```bash
# 查看应用日志
sudo journalctl -u rwa-hub -f

# 查看nginx日志
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/nginx/access.log
```

### 2. 常见问题排查

#### 2.1 分享按钮不显示
- 检查JavaScript错误
- 检查API端点是否可访问
- 确认分享按钮元素存在

#### 2.2 模态框不打开
- 检查Bootstrap.js加载
- 检查JavaScript控制台错误
- 确认模态框HTML正确

#### 2.3 API返回错误
- 检查Flask服务状态
- 检查数据库连接
- 验证API路由配置

#### 2.4 链接生成失败
- 检查短链接服务
- 验证钱包地址获取
- 确认URL编码正确

## 📊 测试结果记录

### 基础功能
- [ ] ✅ 页面加载
- [ ] ✅ 分享按钮
- [ ] ✅ 模态框打开
- [ ] ✅ API调用
- [ ] ✅ 链接生成

### 优化验证
- [ ] ✅ 重复信息已去除
- [ ] ✅ 布局更简洁
- [ ] ✅ 信息层次清晰
- [ ] ✅ 用户体验改善

### 问题记录
```
问题1: [描述]
解决方案: [描述]
状态: [已解决/待解决]

问题2: [描述]  
解决方案: [描述]
状态: [已解决/待解决]
```

## 🎯 验收标准

### 必须通过的测试
1. **分享按钮正常工作** - 用户可以点击分享按钮
2. **模态框正确显示** - 分享模态框能够正常打开和关闭
3. **内容优化生效** - 重复的"20%团队分成"信息已去除
4. **API正常响应** - 所有分享相关API返回正确数据
5. **链接生成成功** - 用户连接钱包后能生成专属分享链接

### 性能要求
- 页面加载时间 < 3秒
- API响应时间 < 1秒
- 模态框打开动画流畅

### 兼容性要求
- Chrome 90+
- Firefox 88+
- Safari 14+
- 移动端浏览器

## 📝 测试报告模板

```
=== 分享页面优化测试报告 ===

测试时间: [日期时间]
测试环境: [服务器信息]
测试人员: [姓名]

部署状态:
- 代码部署: [成功/失败]
- 服务重启: [成功/失败]  
- API可用性: [正常/异常]

功能测试:
- 分享按钮: [正常/异常]
- 模态框显示: [正常/异常]
- 内容优化: [已生效/未生效]
- 链接生成: [正常/异常]

问题列表:
1. [问题描述和解决方案]
2. [问题描述和解决方案]

总体评价: [通过/需要修复]
建议: [改进建议]
```

## 🚨 紧急回滚步骤

如果测试发现严重问题，按以下步骤快速回滚：

```bash
# 1. 停止服务
sudo systemctl stop rwa-hub

# 2. 恢复备份（替换为实际备份路径）
sudo cp -r /var/backups/rwa-hub/[BACKUP_DIR]/* /var/www/RWA-HUB/

# 3. 重启服务
sudo systemctl start rwa-hub
sudo systemctl restart nginx

# 4. 验证回滚成功
curl -I http://localhost
```

---
**注意**: 所有测试必须在服务器环境进行，不要在本地环境测试！ 